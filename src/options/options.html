<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Open Translate - Settings</title>
  <link rel="stylesheet" href="options.css">
</head>
<body>
  <div class="container">
    <!-- Header -->
    <header class="header">
      <div class="header-content">
        <div class="header-text">
          <h1>Open Translate Settings</h1>
          <p>Configure your translation preferences and API settings</p>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
      <!-- API Configuration Section -->
      <section class="settings-section">
        <h2 class="section-title">API Configuration</h2>
        <div class="section-content">
          <div class="form-group">
            <label for="apiUrl" class="form-label">API Endpoint URL</label>
            <input type="url" id="apiUrl" class="form-input" placeholder="https://api.openai.com/v1/chat/completions">
            <small class="form-help">Enter the OpenAI-compatible API endpoint URL</small>
          </div>

          <div class="form-group">
            <label for="apiKey" class="form-label">API Key</label>
            <div class="input-group">
              <input type="password" id="apiKey" class="form-input" placeholder="Enter your API key">
              <button type="button" id="toggleApiKey" class="toggle-btn" title="Show/Hide API Key">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                </svg>
              </button>
            </div>
            <small class="form-help">Your API key will be stored securely in Chrome's sync storage</small>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="model" class="form-label">Model</label>
              <div class="model-selection">
                <select id="model" class="form-select">
                  <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
                  <option value="gpt-4">GPT-4</option>
                  <option value="gpt-4-turbo">GPT-4 Turbo</option>
                  <option value="claude-3-sonnet">Claude 3 Sonnet</option>
                  <option value="claude-3-opus">Claude 3 Opus</option>
                </select>
                <button type="button" id="refreshModels" class="refresh-btn" title="Refresh available models">
                  Refresh Models
                </button>
              </div>
              <small class="form-help">Select a model or use custom model below</small>
            </div>

            <div class="form-group">
              <label for="temperature" class="form-label">Temperature</label>
              <input type="range" id="temperature" class="form-range" min="0" max="1" step="0.1" value="0.3">
              <span id="temperatureValue" class="range-value">0.3</span>
            </div>
          </div>

          <div class="form-group">
            <label for="customModel" class="form-label">
              Custom Model Name
              <span class="priority-indicator" id="modelPriorityIndicator"></span>
            </label>
            <input type="text" id="customModel" class="form-input" placeholder="Enter custom model name (optional)">
            <small class="form-help" id="modelHelp">Leave empty to use the selected model above. Custom model name will override the selected model.</small>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="maxTokens" class="form-label">Max Tokens</label>
              <input type="number" id="maxTokens" class="form-input" min="100" max="4000" value="2000">
            </div>

            <div class="form-group">
              <label for="timeout" class="form-label">Timeout (seconds)</label>
              <input type="number" id="timeout" class="form-input" min="5" max="120" value="30">
            </div>
          </div>

          <div class="form-group">
            <button type="button" id="testConnection" class="test-btn">
              Test Connection
            </button>
            <div id="testResult" class="test-result hidden"></div>
          </div>
        </div>
      </section>

      <!-- Translation Settings Section -->
      <section class="settings-section">
        <h2 class="section-title">Translation Settings</h2>
        <div class="section-content">
          <div class="form-row">
            <div class="form-group">
              <label for="defaultSourceLang" class="form-label">Default Source Language</label>
              <select id="defaultSourceLang" class="form-select">
                <option value="auto">Auto Detect</option>
                <option value="en">English</option>
                <option value="zh-CN">Chinese (Simplified)</option>
                <option value="zh-TW">Chinese (Traditional)</option>
                <option value="ja">Japanese</option>
                <option value="ko">Korean</option>
                <option value="fr">French</option>
                <option value="de">German</option>
                <option value="es">Spanish</option>
                <option value="ru">Russian</option>
              </select>
            </div>

            <div class="form-group">
              <label for="defaultTargetLang" class="form-label">Default Target Language</label>
              <select id="defaultTargetLang" class="form-select">
                <option value="zh-CN">Chinese (Simplified)</option>
                <option value="en">English</option>
                <option value="zh-TW">Chinese (Traditional)</option>
                <option value="ja">Japanese</option>
                <option value="ko">Korean</option>
                <option value="fr">French</option>
                <option value="de">German</option>
                <option value="es">Spanish</option>
                <option value="ru">Russian</option>
              </select>
            </div>
          </div>

          <div class="form-group">
            <label for="defaultMode" class="form-label">Default Translation Mode</label>
            <div class="radio-group">
              <label class="radio-option">
                <input type="radio" name="defaultMode" value="replace" id="defaultModeReplace">
                <span class="radio-label">Replace Mode</span>
                <small class="radio-description">Replace original text with translation</small>
              </label>
              <label class="radio-option">
                <input type="radio" name="defaultMode" value="bilingual" id="defaultModeBilingual">
                <span class="radio-label">Bilingual Mode</span>
                <small class="radio-description">Show original and translated text together</small>
              </label>
            </div>
          </div>
          <div class="form-group">
            <div class="checkbox-group">
              <label class="checkbox-option">
                <input type="checkbox" id="autoTranslateEnabled">
                <span class="checkbox-label">Auto-translate new pages</span>
                <small class="checkbox-description">Automatically translate pages when they load</small>
              </label>



              <label class="checkbox-option">
                <input type="checkbox" id="preserveFormatting">
                <span class="checkbox-label">Preserve formatting</span>
                <small class="checkbox-description">Maintain original text formatting and styles</small>
              </label>
            </div>
          </div>
        </div>
      </section>

      <!-- Advanced Settings Section -->
      <section class="settings-section">
        <h2 class="section-title">Advanced Settings</h2>
        <div class="section-content">
          <div class="form-group">
            <label for="excludeSelectors" class="form-label">Exclude Selectors</label>
            <textarea id="excludeSelectors" class="form-textarea" rows="4" placeholder="Enter CSS selectors to exclude from translation, one per line"></textarea>
            <small class="form-help">CSS selectors for elements that should not be translated</small>
          </div>

          <div class="form-group">
            <label for="batchSize" class="form-label">Concurrent Translation Limit</label>
            <input type="number" id="batchSize" class="form-input" min="1" max="20" value="5">
            <small class="form-help">Number of paragraphs to translate concurrently (higher values = faster translation but more API usage)</small>
          </div>

          <div class="form-group">
            <label for="retryAttempts" class="form-label">Retry Attempts</label>
            <input type="number" id="retryAttempts" class="form-input" min="0" max="5" value="2">
            <small class="form-help">Number of retry attempts for failed translations</small>
          </div>
        </div>
      </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
      <div class="footer-actions">
        <button type="button" id="resetSettings" class="secondary-btn">Reset to Defaults</button>
        <div class="primary-actions">
          <button type="button" id="saveSettings" class="primary-btn">Save Settings</button>
        </div>
      </div>
      <div class="footer-info">
        <p>Open Translate v1.0.0 - A powerful web translation extension</p>
      </div>
    </footer>

    <!-- Status Messages -->
    <div id="statusMessage" class="status-message hidden">
      <div class="status-content">
        <span class="status-text"></span>
        <button class="status-close">&times;</button>
      </div>
    </div>
  </div>

  <script src="../shared/constants.js"></script>
  <script src="../shared/config.js"></script>
  <script src="../shared/utils.js"></script>
  <script src="../shared/errorHandler.js"></script>
  <script src="../core/translator.js"></script>
  <script src="options.js"></script>
</body>
</html>
